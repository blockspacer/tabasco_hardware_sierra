<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>Sierra RIL: hardware/sierra/swicommon/swiril_gps.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Sierra RIL
   &#160;<span id="projectnumber">R0.1</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_ac7df9380ba1d5d3d602df81a60439d8.html">hardware</a></li><li class="navelem"><a class="el" href="dir_d7ff66cbb8db4abd845e01a316f08f99.html">sierra</a></li><li class="navelem"><a class="el" href="dir_9872bb0cbe36d1ff13faa866e6f5a304.html">swicommon</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">swiril_gps.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="swigps__common_8h_source.html">swigps_common.h</a>&quot;</code><br/>
</div>
<p><a href="swiril__gps_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ad4477b6bef7f0283f3327660a837e5ef"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="swiril__gps_8h.html#ad4477b6bef7f0283f3327660a837e5ef">handle_swigps</a> (int fd)</td></tr>
<tr class="separator:ad4477b6bef7f0283f3327660a837e5ef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4de9283cc0cca1bf26e542d0e538f7ab"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="swiril__gps_8h.html#a4de9283cc0cca1bf26e542d0e538f7ab">RILGPS_Init</a> (<a class="el" href="swigps__common_8h.html#a3885b30fb9d10f9adf67f9f65eb450a4">GPS_RILTYPE</a> riltype)</td></tr>
<tr class="separator:a4de9283cc0cca1bf26e542d0e538f7ab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a28b870d2ba4f7dc522438658d099522b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="swiril__gps_8h.html#a28b870d2ba4f7dc522438658d099522b">initializeRILType</a> (<a class="el" href="swigps__common_8h.html#a3885b30fb9d10f9adf67f9f65eb450a4">GPS_RILTYPE</a> riltype)</td></tr>
<tr class="separator:a28b870d2ba4f7dc522438658d099522b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a14fcafcbe266a8b788d2441222ed7811"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="swiril__gps_8h.html#a14fcafcbe266a8b788d2441222ed7811">rilgpsGetDef</a> (void *)</td></tr>
<tr class="separator:a14fcafcbe266a8b788d2441222ed7811"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aab2532dfe9fad99d9fcdfab8a47b4a23"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="swiril__gps_8h.html#aab2532dfe9fad99d9fcdfab8a47b4a23">rilgpsSetDef</a> (void *)</td></tr>
<tr class="separator:aab2532dfe9fad99d9fcdfab8a47b4a23"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acbb4d9cfd2eb7da69d8ae8960429c380"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="swiril__gps_8h.html#acbb4d9cfd2eb7da69d8ae8960429c380">rilgpsGetAgps</a> (void *)</td></tr>
<tr class="separator:acbb4d9cfd2eb7da69d8ae8960429c380"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af58a08f0833abc5a2f32b48095ae3aeb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="swiril__gps_8h.html#af58a08f0833abc5a2f32b48095ae3aeb">rilgpsSetAgps</a> (void *)</td></tr>
<tr class="separator:af58a08f0833abc5a2f32b48095ae3aeb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5bef6320798174aa28a5086253680ea6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="swiril__gps_8h.html#a5bef6320798174aa28a5086253680ea6">rilgpsInjTime</a> (void *)</td></tr>
<tr class="separator:a5bef6320798174aa28a5086253680ea6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a35045a58ac57cfffb1c34493b87a91b3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="swiril__gps_8h.html#a35045a58ac57cfffb1c34493b87a91b3">rilgpsStopSession</a> (void *)</td></tr>
<tr class="separator:a35045a58ac57cfffb1c34493b87a91b3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae16f3fddd3268ebb7ea0fb5bf2403137"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="swiril__gps_8h.html#ae16f3fddd3268ebb7ea0fb5bf2403137">rilgpsStartSession</a> (void *paramp)</td></tr>
<tr class="separator:ae16f3fddd3268ebb7ea0fb5bf2403137"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><dl class="section author"><dt>Author</dt><dd>Copyright: © 2011 Sierra Wireless, Inc. All rights reserved</dd></dl>
<dl class="section note"><dt>Note</dt><dd>See also <a class="el" href="swigps__common_8h.html" title="Definitions for vendor specific GPS handling which are common to to the RIL side and the GPS Interfac...">swigps_common.h</a> for an explanation of naming conventions used by the vendor specific GPS code </dd></dl>
</div><h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="ad4477b6bef7f0283f3327660a837e5ef"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void handle_swigps </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fd</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Handle incoming swigps traffic, arranging to parse it and then dispatching the appropriate handler for it. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">fd</td><td>A socket descriptor to use for communication with the peer</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>none</dd></dl>
<dl class="section user"><dt>Abort: </dt><dd>none</dd></dl>
<dl class="section note"><dt>Note</dt><dd>This function remains in control until the socket closes and then it returns to the caller until another connection is accepted. It also bails out if any other error condition is detected. Check the logs to find out the reason </dd></dl>

</div>
</div>
<a class="anchor" id="a28b870d2ba4f7dc522438658d099522b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void initializeRILType </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="swigps__common_8h.html#a3885b30fb9d10f9adf67f9f65eb450a4">GPS_RILTYPE</a>&#160;</td>
          <td class="paramname"><em>riltype</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize the RIL type for future comparison against what the GPS vendor specific code expects to be running. </p>
<p>Could be either the AT or the QMI RIL and the GPS vendor specific module's dynamic library must match. The remedy is to ensure the GPS and RIL library are of the same type</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">riltype</td><td>The type of RIL the caller is</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>none</dd></dl>
<dl class="section user"><dt>Abort: </dt><dd>none</dd></dl>
<dl class="section note"><dt>Note</dt><dd>No validation is performed, it is expected the caller will get it right. An error will be logged if there's a mismatch This function must be called before any others in this file </dd></dl>

</div>
</div>
<a class="anchor" id="a4de9283cc0cca1bf26e542d0e538f7ab"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void RILGPS_Init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="swigps__common_8h.html#a3885b30fb9d10f9adf67f9f65eb450a4">GPS_RILTYPE</a>&#160;</td>
          <td class="paramname"><em>riltype</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize the RILGPS functions. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">riltype</td><td>The type of RIL driving this instance of the GPS thread, GPS_RILTYPE_QMI or GPS_RILTYPE_AT</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>None</dd></dl>
<dl class="section user"><dt>Abort: </dt><dd>none</dd></dl>
<dl class="section note"><dt>Note</dt><dd>none </dd></dl>

</div>
</div>
<a class="anchor" id="acbb4d9cfd2eb7da69d8ae8960429c380"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void rilgpsGetAgps </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>paramp</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>GPS QMI agent for getting AGPS information from the modem and sending it back to the swigps daemon. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">paramp</td><td>Indicates which file handle to use when replying to the sgi side once the default PDS settings have been received from the modem</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>none</dd></dl>
<dl class="section user"><dt>Abort: </dt><dd>none</dd></dl>
<dl class="section note"><dt>Note</dt><dd>Runs in the context of the RIL daemon</dd></dl>
<p>Not used at the moment. Placeholder in case it is needed</p>
<p>TODO This function does not support returning the AGPS Server's URL yet. Once the SLQS API supports returning the URL, this function should be updated to include it. </p>

</div>
</div>
<a class="anchor" id="a14fcafcbe266a8b788d2441222ed7811"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void rilgpsGetDef </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>paramp</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>GPS QMI agent which handles the request to get PDS default settings from a QMI modem. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">paramp</td><td>Indicates which file handle to use when replying to the sgi side once the default PDS settings have been received from the modem</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>none</dd></dl>
<dl class="section user"><dt>Abort: </dt><dd>none</dd></dl>
<dl class="section note"><dt>Note</dt><dd>Runs in the context of the RIL daemon </dd></dl>

</div>
</div>
<a class="anchor" id="a5bef6320798174aa28a5086253680ea6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void rilgpsInjTime </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>paramp</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>GPS QMI agent for handling requests to inject time into the modem. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">Pointer</td><td>to an array of memory containing the values passed from the swigps package. Needs to be unpacked into local variables </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>none</dd></dl>
<dl class="section user"><dt>Abort: </dt><dd>none</dd></dl>
<dl class="section note"><dt>Note</dt><dd>Runs in the context of the RIL daemon</dd></dl>
<p>This function is not re-entrant because the urlbuf is statically declared to save putting too much storage on the stack </p>

</div>
</div>
<a class="anchor" id="af58a08f0833abc5a2f32b48095ae3aeb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void rilgpsSetAgps </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>paramp</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>GPS QMI agent for setting AGPS information on the modem and sending it back to the swigps daemon. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">Pointer</td><td>to an array of memory containing the values passed from the swigps package. Needs to be unpacked into local variables </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>none</dd></dl>
<dl class="section user"><dt>Abort: </dt><dd>none</dd></dl>
<dl class="section note"><dt>Note</dt><dd>Runs in the context of the RIL daemon</dd></dl>
<p>This function is not re-entrant because the urlbuf is statically declared to save putting too much storage on the stack</p>
<p>This function configures either the IP address and port number or the hostname URL and it's associated length. For this reason the AGPS interface function in <a class="el" href="swigps_8c.html">swigps.c</a> accepts an IP address in ASCII form and converts it into its binary equivalent.</p>
<p>The question of whether the QMI device would accept a host URL and port number encoded as: </p>
<pre class="fragment">                 www.hostname.com:&lt;port&gt;
</pre><p>is not known. Although the API accepts this combination it is unclear whether it actually works as expected within a GOBI device</p>
<p>To use:</p>
<ul>
<li>If the IP Address and port number fields contain a value then the IP address and port number are configured</li>
<li>If the IP address or port number are NULL and the host URL is a string longer than MINURL bytes then it is configured </li>
</ul>

</div>
</div>
<a class="anchor" id="aab2532dfe9fad99d9fcdfab8a47b4a23"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void rilgpsSetDef </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>paramp</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>GPS QMI Agent to process a request to set the PDS default values in a QMI modem. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">paramp</td><td>A pointer to the arguments sent by the swigps daemon. NOTE: This points to a block of allocated memory and must be freed before returning from this handler</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>none</dd></dl>
<dl class="section user"><dt>Abort: </dt><dd>none</dd></dl>
<dl class="section note"><dt>Note</dt><dd>Runs in the context of the RIL daemon</dd></dl>
<p>The incoming arguments are stored in network byte order in a buffer pointed to by paramp. The order of arguments is:</p>
<p>fd - File descriptor for socket connection to swigps args - Packet bytes which follow the format of the PDS Defaults Request packet, documented in the "Software Design Specification for Android GPS
                 Vendor Specific Location"</p>
<p>This function ignores the "tracking" status byte at the end of the incoming parameters packet </p>

</div>
</div>
<a class="anchor" id="ae16f3fddd3268ebb7ea0fb5bf2403137"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void rilgpsStartSession </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>paramp</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>GPS QMI agent for handling start session requests. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">Pointer</td><td>to an array of memory containing the values passed from the swigps package. Unused variables </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>none</dd></dl>
<dl class="section user"><dt>Abort: </dt><dd>none</dd></dl>
<dl class="section note"><dt>Note</dt><dd>Runs in the context of the RIL daemon</dd></dl>
<p>Does nothing, the Start Session request is an AT modem- only requirement </p>

</div>
</div>
<a class="anchor" id="a35045a58ac57cfffb1c34493b87a91b3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void rilgpsStopSession </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>paramp</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>GPS QMI agent for handling stop session requests. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">Pointer</td><td>to an array of memory containing the values passed from the swigps package. Unused </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>none</dd></dl>
<dl class="section user"><dt>Abort: </dt><dd>none</dd></dl>
<dl class="section note"><dt>Note</dt><dd>Runs in the context of the RIL daemon</dd></dl>
<p>Does nothing, the Stop Session request is an AT modem- only requirement </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue Jul 11 2017 08:56:10 for Sierra RIL by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.6
</small></address>
</body>
</html>
